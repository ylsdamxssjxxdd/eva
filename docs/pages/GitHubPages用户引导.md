# EVA 机体：一款轻量 Agent 桌面端拘束器

欢迎使用 EVA —— 一个基于“约定框架”的智能体桌面应用，灵感源自《新世纪福音战士》。EVA 将大语言模型（驾驶员）装载到机体中，通过工具调用与现实世界交互，帮助指挥员（您）完成复杂任务。

本页面是 EVA 的入门指南，面向新用户提供最直接的路径。如果您是开发者，请参阅[软件技术说明书](../软件技术说明书.md)。

![EVA 机体界面预览](../images/hero-placeholder.png)

## ✨ 核心亮点

- **模型装载**：支持**本地模式**（离线、低延迟）与**链接模式**（连接云端 API）。
- **工具调用**：内置计算器、知识库、系统工程师、MCP 等工具，模型可自主调用。
- **增殖扩展**：文生图、语音转文字、知识库构建、模型量化等进阶功能。
- **智能后端**：首次启动自动扫描 `EVA_BACKEND` 目录，为您选择合适的推理设备。
- **安全沙盒**：高风险命令可在 Docker 容器中执行，保护主机环境。

## 🚀 快速开始（3 分钟）

### 第 1 步：选择模式

根据您的环境和需求选择一种模式：

| 模式 | 适合场景 | 准备要求 |
|------|----------|----------|
| **本地模式** | 希望离线运行、拥有 GPU 或 CPU 算力 | 下载 GGUF 模型，放置于你能找到的目录里 |
| **链接模式** | 希望快速体验、使用云端 API（如 OpenAI、Groq、DeepSeek 等） | 拥有可用的 OpenAI 兼容端点、API 密钥与模型名称 |

### 第 2 步：装载机体

1. 启动 EVA 应用。
2. 点击 **“装载”** 按钮。
3. 根据上一步的选择：
   - **本地模式**：在弹出的文件对话框中选择 GGUF 模型文件，确认后等待后端启动（界面显示“装载中”）。
   - **链接模式**：填写 endpoint、API Key 和 model 名称，确认后切换为远端连接。
4. 界面状态变为 **“正常”** 后，即可开始对话。

### 第 3 步：发送第一条消息

在输入框中键入问题，按 `Ctrl+Enter` 或点击 **“发送”**。您还可以：
- **附加图片**：拖拽图片到输入区，或按 `F1` 截图。
- **附加音频**：上传 WAV/MP3/OGG/FLAC 文件，或按 `F2` 录音转文字。
- **使用工具**：在“约定”面板启用所需工具，模型将自动调用。

完成以上三步，您已成功驾驶 EVA！接下来可以探索更多功能。

## 📖 功能导航（12 步精通）

我们为每个核心功能准备了独立页面，建议按顺序体验，也可根据需求跳转：

1.  **[对话：日常聊天](01-对话.md)** – 基础聊天、多模态输入、快捷键与状态说明。
2.  **[补完：初始形态](02-补完.md)** – 长文续写、代码补全、一次性输出模式。
3.  **[语音交互：开麦即聊](03-语音交互.md)** – 录音转写、音频上传、Whisper 模型使用。
4.  **[视觉交互：看图说话](04-视觉交互.md)** – 图片解读、截图分析、视觉模型挂载。
5.  **[文生图：幻想成真](05-文生图.md)** – 使用 Stable Diffusion/Flux 生成图像。
6.  **[知识库：你的私有仓库](06-知识库.md)** – 构建私有向量库，让模型基于文档回答。
7.  **[MCP：连接外部服务](07-MCP.md)** – 接入 MCP 服务器，扩展模型工具集。
8.  **[系统工程师：命令与编程协作](08-系统工程师.md)** – 执行命令、读写文件、编写脚本。
9.  **[使用沙盒：把高风险关进盒子](09-使用沙盒.md)** – 在 Docker 容器中运行命令，隔离风险。
10. **[使用技能：外挂式工作流](10-使用技能.md)** – 安装技能包，为模型添加特定场景能力。
11. **[系统架构师：代理的代理](11-系统架构师.md)** – 让模型输出架构设计、接口定义、实施方案。
12. **[机体控制：远程接管](12-机体控制.md)** – 远程协同、多机切换、安全控制。

## 🔧 常见问题（FAQ）

### 装载问题
- **Q：本地模式装载卡住，没有反应？**  
  A：请检查“模型日志”页是否出现 `listening on` 或 `ready` 字样；确保模型路径正确、后端可执行文件有运行权限；尝试关闭 mmap（在设置中取消勾选）或减少 GPU 层数（ngl）。
- **Q：链接模式提示“端点无响应”**  
  A：确认 endpoint 填写到 `/v1` 根路径（例如 `https://api.openai.com/v1`），检查网络连接、防火墙、API 密钥是否正确，以及模型名称是否存在。

### 运行问题
- **Q：工具调用陷入循环，不停重复？**  
  A：可能在非思考区域出现了工具结束标记；尝试在“约定”中调整工具停词，或要求模型“先思考再调用”。
- **Q：图片/音频发送后模型说看不到？**  
  A：确认发送时图片/音频已正确附加（输入框下方有预览）；本地模式需确保视觉/音频解码模型已正确挂载。
- **Q：知识库检索无结果？**  
  A：检查嵌入服务是否启动、文档是否已入库；可在“增殖-知识库”页面查看入库状态。

### 性能与兼容性
- **Q：显存不足，如何调整？**  
  A：在“设置”中降低 GPU 层数（ngl），或切换到 CPU/OpenCL 模式；首次装载会根据可用显存自动估算，装载后可根据 `n_layer+1` 手动微调。
- **Q：在旧 CPU 上启动时崩溃，提示 SIGILL？**  
  A：这是 Qt 正则表达式的 PCRE2 JIT 问题；EVA 已禁用 `static QRegularExpression`，请确保使用最新版本。

## 📸 截图与部署

- **截图**：各功能页面配有界面截图（位于 `docs/images/pages/`），帮助您直观对照。目前部分截图仍为占位图，我们将陆续替换为实际运行画面。
- **本地预览**：安装 MkDocs 与 Material 主题后，可通过以下命令在本地查看本站：
  ```bash
  pip install mkdocs mkdocs-material
  mkdocs serve
  ```
- **部署到 GitHub Pages**：使用 [peaceiris/actions-gh-pages](https://github.com/peaceiris/actions-gh-pages) 或类似 Action，将 `mkdocs build` 生成的 `site/` 目录发布到 gh-pages 分支。

## 📝 维护与贡献

- **功能迭代**：最新更新记录在 [功能迭代.md](../功能迭代.md)。
- **文档改进**：如果您发现文档有误或缺失，欢迎提交 Pull Request 或 Issue。
- **反馈与交流**：请通过 GitHub 仓库的 Discussions 或 Issues 与我们联系。

---

**下一步**：建议从 **[对话：开局即用](01-对话.md)** 开始，逐步掌握 EVA 的全部能力。

> 记住：您是指挥员，模型是驾驶员，EVA 是机体。约定框架让三者协同，完成您的一切野心。
