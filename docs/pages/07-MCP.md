# 07 MCP：连接外部服务

## 你能完成
- 将外部 API/数据库/业务系统通过 MCP 接入，模型可直接调用。
- 在对话里看到工具回显、参数与结果，继续推理直到任务结束。
- 按需切换 SSE / Streamable HTTP / stdio 协议，持久化服务列表。

## 开始前
- 准备 MCP 服务器地址与服务名（如 `service@tool`），确认可达。
- 在“约定”勾选 MCP 工具，允许模型调用；必要时写入限流/安全边界。
- 如果需要持久化/刷新列表，可在“增殖-MCP”配置，EVA 会保存到 `EVA_TEMP/mcp_servers.json` 并自动刷新启用的服务。

## 操作步骤
1. 打开“增殖-MCP”，添加/启用目标服务（支持 SSE、streamable HTTP、stdio）；点击刷新会探测工具列表与 schema。
2. 在“约定”启用 MCP 工具并保存，重置后系统提示会注入工具描述与调用格式。
3. 回到对话描述需求，模型输出 `<tool>...</tool>` JSON 触发调用；EVA 执行后以 `tool_response:` 回填。
4. 若需要连续调用，模型会继续输出下一次 `<tool>`，直到完成；没有 `<tool>` 即视为回答完成。

## 常见问题
- **超时/无回应**：检查服务器连通、防火墙/代理；确认选择了正确的协议与端点。
- **参数错乱**：在约定写示例调用；让模型先回显参数再执行。
- **服务冲突**：同一问题涉及多服务时，在提问中明确指定或限制操作范围。

![MCP 页面示意](../images/pages/07-mcp.png)

[返回总览](../index.md) · [上一页：知识库](06-知识库.md) · [下一页：系统工程师](08-系统工程师.md)
